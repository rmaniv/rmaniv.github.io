<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Vinamr Sachdeva">
<meta name="dcterms.date" content="2023-08-22">

<title>Vinamr Sachdeva - McKinsey’s estimate for global land value</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Vinamr Sachdeva</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/vinamrsachdeva" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/vinamrsachdeva" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://old.reddit.com/u/vinamrsachdeva" rel="" target=""><i class="bi bi-reddit" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:vinamrsachdeva@gmail.com" rel="" target=""><i class="bi bi-envelope" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">McKinsey’s estimate for global land value</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">georgism</div>
                <div class="quarto-category">land</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Vinamr Sachdeva </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">August 22, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#estimate" id="toc-estimate" class="nav-link active" data-scroll-target="#estimate"><span class="header-section-number">1</span> Estimate</a>
  <ul class="collapse">
  <li><a href="#global-land-value-and-other-assets" id="toc-global-land-value-and-other-assets" class="nav-link" data-scroll-target="#global-land-value-and-other-assets"><span class="header-section-number">1.1</span> Global land value (and other assets)</a></li>
  <li><a href="#land-and-other-assets-held-by-households" id="toc-land-and-other-assets-held-by-households" class="nav-link" data-scroll-target="#land-and-other-assets-held-by-households"><span class="header-section-number">1.2</span> Land (and other assets) held by households</a></li>
  <li><a href="#land-and-other-assets-held-by-the-government" id="toc-land-and-other-assets-held-by-the-government" class="nav-link" data-scroll-target="#land-and-other-assets-held-by-the-government"><span class="header-section-number">1.3</span> Land (and other assets) held by the government</a></li>
  <li><a href="#land-and-other-assets-held-by-the-non-financial-corporate-sector" id="toc-land-and-other-assets-held-by-the-non-financial-corporate-sector" class="nav-link" data-scroll-target="#land-and-other-assets-held-by-the-non-financial-corporate-sector"><span class="header-section-number">1.4</span> Land (and other assets) held by the non-financial corporate sector</a></li>
  </ul></li>
  <li><a href="#methodology" id="toc-methodology" class="nav-link" data-scroll-target="#methodology"><span class="header-section-number">2</span> Methodology</a>
  <ul class="collapse">
  <li><a href="#japan-australia-germany-france-united-kingdom" id="toc-japan-australia-germany-france-united-kingdom" class="nav-link" data-scroll-target="#japan-australia-germany-france-united-kingdom"><span class="header-section-number">2.1</span> Japan, Australia, Germany, France, United Kingdom</a></li>
  <li><a href="#united-states" id="toc-united-states" class="nav-link" data-scroll-target="#united-states"><span class="header-section-number">2.2</span> United States</a></li>
  <li><a href="#china" id="toc-china" class="nav-link" data-scroll-target="#china"><span class="header-section-number">2.3</span> China</a></li>
  <li><a href="#methodology-for-government-assets" id="toc-methodology-for-government-assets" class="nav-link" data-scroll-target="#methodology-for-government-assets"><span class="header-section-number">2.4</span> Methodology for government assets</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>McKinsey, in its “<a href="https://www.mckinsey.com/industries/financial-services/our-insights/the-rise-and-rise-of-the-global-balance-sheet-how-productively-are-we-using-our-wealth">The rise and rise of the global balance sheet</a>,” provides land value estimates for 10 countries (Australia, Canada, China, France, Germany, Japan, Mexico, Sweden, UK and the US) and extrapolates that for the world.</p>
<section id="estimate" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="estimate"><span class="header-section-number">1</span> Estimate</h2>
<p>Their estimate for global land value is 35% of USD 520 trillion, i.e.&nbsp;USD 182 trillion. Global GDP in 2020 <a href="https://data.worldbank.org/indicator/NY.GDP.MKTP.CD">was</a> about USD 85 trillion. So their estimate for global land value is a little more than 2 times global GDP.</p>
<section id="global-land-value-and-other-assets" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="global-land-value-and-other-assets"><span class="header-section-number">1.1</span> Global land value (and other assets)</h3>
<p><img src="mckinsey.png" class="img-fluid"></p>
</section>
<section id="land-and-other-assets-held-by-households" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="land-and-other-assets-held-by-households"><span class="header-section-number">1.2</span> Land (and other assets) held by households</h3>
<p><img src="mckinsey-house.png" class="img-fluid"></p>
</section>
<section id="land-and-other-assets-held-by-the-government" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="land-and-other-assets-held-by-the-government"><span class="header-section-number">1.3</span> Land (and other assets) held by the government</h3>
<p><img src="mckinsey-gov.png" class="img-fluid"></p>
</section>
<section id="land-and-other-assets-held-by-the-non-financial-corporate-sector" class="level3" data-number="1.4">
<h3 data-number="1.4" class="anchored" data-anchor-id="land-and-other-assets-held-by-the-non-financial-corporate-sector"><span class="header-section-number">1.4</span> Land (and other assets) held by the non-financial corporate sector</h3>
<p><img src="mckinsey-corp.png" class="img-fluid"></p>
<p>I’ve left out the financial sector from this post because it’s negligible for them.</p>
</section>
</section>
<section id="methodology" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="methodology"><span class="header-section-number">2</span> Methodology</h2>
<p>They use data from OECD, the national statistics offices for most countries and the Federal Reserve for the US. Some relevant excerpts for the methodologies used:</p>
<section id="japan-australia-germany-france-united-kingdom" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="japan-australia-germany-france-united-kingdom"><span class="header-section-number">2.1</span> Japan, Australia, Germany, France, United Kingdom</h3>
<blockquote class="blockquote">
<p>— Japan, Australia, and Germany, the value of land underlying structures is based directly on the quantity of land multiplied by estimated market prices. In France and the United Kingdom, a residual approach is followed, where the total value of real estate is estimated and then the cost of the structure is subtracted. In the United States, the Federal Reserve and Bureau of Economic Analysis (BEA) do not publish separate estimates for land. The BEA cautions against forming a specific land stock value using the residual approach, because data on real estate stock are estimated separately from the value of structure replacement cost. In such a case, the final value of land could potentially be inaccurate due to source discrepancies. For more on how we calculated land values for the United States, see “United States: Splitting real estate totals into land, dwellings, buildings, and infrastructure,” below.</p>
</blockquote>
</section>
<section id="united-states" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="united-states"><span class="header-section-number">2.2</span> United States</h3>
<blockquote class="blockquote">
<p>For the United States balance sheet data, we leveraged the Federal Reserve Board’s Z.1 accounts.[196] They treat real estate as a nonfinancial asset, including land and structures (dwellings, buildings, and infrastructure).</p>
<p>To gain more detail, we first estimated the value of land based on guidance and inputs from several papers.197 We separately estimate, and then combine, private land, government land, and farmland.</p>
<p>— Private land: The Federal Reserve reported real estate stock data as a total of private land and structures as well as structures excluding land. The value of private land was estimated as the difference between the real estate value and the value of private structures.</p>
<p>— Government land: Larson (2015) calculates the share of total land owned by governments. We applied this estimate to our private land value estimates to reach a value for government land.</p>
<p>— Farmland: The US Department of Agriculture provided an estimate of total farmland, which we adjusted to nominal prices by applying a GDP chain-type price index. 198</p>
<p>Structures were then estimated as the difference between published real estate values and estimated land figures. To distribute total structures across dwellings, nonresidential buildings, and infrastructure, we used splits implied by the OECD’s published figures for the United States by sector.</p>
<p>[Footnotes:]</p>
<p>[196] “Financial accounts of the United States – Z.1,” Federal Reserve Board, 2021, federalreserve.gov.</p>
<p>[197] See William Larson, New estimates of value of land of the United States, Bureau of Economic Analysis, US Department of Commerce, April 2015, bea.gov; and Joseph B. Nichols, Stephen D. Oliner, and Michael R. Mulhall, Commercial and residential land prices across the United States, Federal Reserve Board, February 2010, federalreserve.gov.</p>
</blockquote>
</section>
<section id="china" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="china"><span class="header-section-number">2.3</span> China</h3>
<blockquote class="blockquote">
<p>Broadly, three land types need to be considered in valuing China’s land stock: urban land, agricultural and rural land owned by rural cooperatives, and land use rights. Land stock reported directly in China’s national accounts represents urban land owned by the government that has not been leased but does not appear to include the other two categories.</p>
<p>Urban land is a government-owned asset and is directly reported along with fixed assets and other balance sheet items described above. Urban land value is based on the total estimate of urban land reserves, for which the right of use has not been yet granted or sold. It is estimated based on the value of new land designated for construction adjusted by a factor of three.[188]</p>
<p>Agricultural and rural land, which are owned by rural cooperatives in China, are not directly reported in official national balance sheet data. Li and Zhang (2017) provide estimates for this form of land for the period 2007–11 based on the present value of the net output of agriculture, forestry, animal husbandry, and fishery, and reflecting a 4 percent discount rate and 40 percent rental rate.[189] We leveraged this approach to extend figures for agricultural and rural land beyond 2011 via statistics on agricultural output from IHS Markit.</p>
<p>[188] Yang Li, Xiaojing Zhang, and Xin Chang, China’s national balance sheet 2018, China Social Sciences Press, November 2018.</p>
<p>[189] Yang Li and Xiaojing Zhang, China’s national balance sheet: Theories, methods, and risk assessments, Springer, 2017.</p>
<p>Land use rights are owned by the household sector and are also not directly reported in official national balance sheet data. Land use rights, granted for decades-long periods by the Chinese government under a leasehold system, constitute a significant portion of privately owned property values in China. [190] We estimated land use rights in 2009 based on a survey by the Chinese Ministry of Land and Resources and then reallocated that total from dwellings to land in the household sector. The share of land use rights from structures was projected forward from 2010 to 2020 and backward from 2008 to 2000 using land and construction price indexes and implied net fixed capital formation in structures.[191]</p>
<p>Prior to the land use rights adjustment, both dwellings including buildings and land were outliers. Dwellings including buildings was 3.1 times GDP, while in other countries it ranged from 1.2 to 2.3 times GDP. Land accounted for significantly lower value than in most other countries apart from Mexico and the United States. After reallocating the value of land use rights from structures into land, both figures for China were closer to the typical range of values observed in other countries (Exhibit A3).</p>
<p>[Footnotes:]</p>
<p>[190] “Special investigation by the Ministry of Land and Resources reveals the ratio of land and house prices to real estate projects,” Chinese Ministry of Land and Resources, Central Government Portal, July 2009, gov.cn. Land use rights as a percentage of property price was available only for 2009; percentages before and after 2009 were estimated by adjusting using the land price index for 2004–11 and the construction price index from 2012 onward. The Ministry of Land and Resources has since become the Ministry of Natural Resources of the People’s Republic of China.</p>
<p>[191] For the real land price index from 2004–11, see Yongheng Deng, Joseph Gyourko, and Jing Wu, Land and housing price measurement in China, National Bureau of Economic Research, working paper number 18403, September 2012, nber.org. The construction price index is calculated via construction sector gross output from IHS Markit. For the 2004–11 period, the real land prices index adjusted for the consumer price index was used to adjust the 2009 implied value of land use rights. For the period 2012–20, the construction price index was used after adjusting for net fixed capital formation, which additionally contributed to the change in values for the non-land proportion of the property value. For the 2000–03 period, values were based on annual growth of land prices in the 2004–11 period.</p>
<p>[…]</p>
<p><img src="china-adjustments.png" class="img-fluid"></p>
</blockquote>
</section>
<section id="methodology-for-government-assets" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="methodology-for-government-assets"><span class="header-section-number">2.4</span> Methodology for government assets</h3>
<blockquote class="blockquote">
<p>— Government accounting varies in robustness by country, which may result in undervaluation of public assets.[183]</p>
<p>[Footnotes:]</p>
<p>[183] Most governments use cash accounting rather than accrual accounting, and as a result balance sheet assets are based on statistical estimates. For further information, see Ian Ball and Gary Pflugrath, “Government accounting: Making Enron look good,” World Economics Journal, March 2012, Volume 13, Number 1.</p>
</blockquote>
<p>In IMF’s Fiscal Monitor, they published “<a href="https://www.imf.org/en/Publications/FM/Issues/2018/10/04/fiscal-monitor-october-2018">Managing Public Wealth</a>,” in October 2018, where they estimate public (government-owned) wealth at <a href="https://www.imf.org/en/Blogs/Articles/2018/10/10/blog-FM-the-wealth-of-nations-govts-can-better-manage-what-they-own-owe">“USD 101 trillion, or 219 percent of GDP”, for the 31 countries they studied and the net worth to be well above “well above 100 percent of GDP.</a>”</p>
<p><img src="gov-net-worth-imf.png" class="img-fluid"></p>
<p>This shows that McKinsey’s estimate, which puts government net worth well below 100% of GDP, at about 40% of GDP for the world, is quite conservative.</p>
<script src="https://utteranc.es/client.js" repo="vinamrsachdeva/vinamrsachdeva.github.io" issue-term="pathname" label="comments" theme="github-light" crossorigin="anonymous" async="">
</script>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>